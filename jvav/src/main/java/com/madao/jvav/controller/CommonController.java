package com.madao.jvav.controller;

import com.madao.jvav.pojo.Payloads;
import com.madao.jvav.util.CheckAllKey;
import com.madao.jvav.util.ExploitGadget;
import com.madao.jvav.util.VerifyGadget;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.web.bind.annotation.*;
import java.io.IOException;


@RestController
@CrossOrigin
public class CommonController {

    @Autowired
    private CheckAllKey checkAllKey;
    @Autowired
    private VerifyGadget verifyGadget;
    @Autowired
    private ExploitGadget exploitGadget;


    /*
    * 寻找有效的 key
    * */
    @GetMapping("/check")
    public String checkKey(@RequestParam("url") String url) throws IOException {
        String checkResult = checkAllKey.keyCheck(url);
        return checkResult;
    }

    /*
    * 寻找有效的 gadget
    * */
    @PostMapping("/hello")
    public void test(@RequestBody Payloads payloads) {
        try {
            verifyGadget.getValidGadget(payloads);
        } catch (Exception e) {
            e.printStackTrace();
        }

    }

    @PostMapping("/exploit")
    public void exploit(@RequestBody Payloads payloads) {
        try {
            exploitGadget.exploit(payloads);
        } catch (Exception e) {
            e.printStackTrace();
        }
    }

}
